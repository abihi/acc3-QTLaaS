#cloud-config

apt_update: true
apt_upgrade: true
packages:
 - build-essential
byobu_default: system

runcmd:
 - export OS_AUTH_URL=https://uppmax.cloud.snic.se:5000/v3
 - export OS_PROJECT_ID=2344cddf33a1412b846290a9fb90b762
 - export OS_PROJECT_NAME="SNIC 2018/10-30"
 - export OS_USER_DOMAIN_NAME="snic"
 - export OS_PROJECT_DOMAIN_NAME="snic"
 - if [ -z "$OS_USER_DOMAIN_NAME" ]; then unset OS_USER_DOMAIN_NAME; fi
 - unset OS_TENANT_ID
 - unset OS_TENANT_NAME
 - export OS_USERNAME="s11856"
 - export OS_PASSWORD="acc3project"
 - export OS_REGION_NAME="UPPMAX"
 - if [ -z "$OS_REGION_NAME" ]; then unset OS_REGION_NAME; fi
 - export OS_INTERFACE=public
 - export OS_IDENTITY_API_VERSION=3

 - echo "export PATH=$PATH:/usr/games" >> /home/ubuntu/.bashrc
 - source /home/ubuntu/.bashrc
 - source /home/ubuntu/bihi-openrc.sh

 - echo Det funkar | sudo tee -a /etc/hosts

 - cd /home/ubuntu/QTLaaS
 - ansible-playbook -s --private-key /home/ubuntu/.ssh/id_rsa spark_deployment.yml
